# 8장_URL 단축기 설계

### API endpoint

1. URL 단축용 엔드포인트
    - 인자 : longURL
    - 요청 : POST
    - 반환 : 단축 URL
2. URL 리디렉션용 엔드포인트
    - 축약된 URL로 HTTP 요청이 오면 원래 URL로 안내
    - 해시테이블에 <단축 URL, 원래 URL> 의 쌍을 저장하는 방식으로 구현 가능
    - 반환 : HTTP 리디렉션 목적지가 될 원래 URL
    - GET

### URL 리디렉션

- 301 Permanently moved
    - 해당 URL (단축 URL)에 대한 HTTP 요청의 처리 책임이 원래 URL로 영구적으로 이전되었다는 응답
        - 브라우저는 이 응답을 cache함
    - 서버 부하를 줄이는게 중요할 때 사용
- 302 Found
    - 일시적으로 URL의 요청이 원래 URL에 의해 처리되어야 한다는 응답
    - 클라이언트 요청은 항상 단축 URL에게 먼저 보내진 후, 원래 URL로 리디렉션 됌
    - 트래픽 분석(클릭 발생률, 발생 위치 추적)이 중요할 때 사용
    

### URL 단축

그림 8-7 !! 

- 긴 URL을 해시값으로 대응시킬 해시 함수 f 찾기
1. 해시 후 충돌해소 방법
    - 해시 함수를 돌린 결과가 7보다 길면, 첫 7자리까지만 사용
    - 충돌이 발생했을 경우(이미 DB에 있는 URL일 경우) 사전에 정한 문자열을 long URL에 덧붙인 후 다시 해시 구하기
    - 7 : 이 예제에서 정한 hashvalue의 길이
    - 오버헤드가 큼 (DB 여러번 query)
2. base-62 변환
    - 62진법 사용
    - ID 값이 커지면 단축 URL 길이도 길어짐
    - ID의 유일성이 보장된 이후에 적용 가능한 전략 → 충돌 가능성 zero
