# 분산 시스템을 위한 유일 ID 생성기 설계
분산 환경에서 auto_increment를 사용하는 것은 정답이 아니다.
## 1. 문제 이해 및 설계 범위 확정
질문을 통해 요구사항을 이해하고 모호함을 해소하는 데 초점을 맞춰야 한다.

## 2. 개략적 설계안 제시 및 동의 구하기

#### 다중 마스터 복제
데이터베이스의 auto_increment를 사용하는 방법으로서 id 값을 증가시킬 때 데이터베이스 서버의 수만큼 증가시키는 방법이다.
하지만 이 방법은 대규모로 늘리기 어렵고 서버 추가, 삭제 시 잘 동작하기가 힘들다.

#### UUID
컴퓨터에서 정보를 식별하기 위한 128 비트짜리 수로 충돌 가능성이 지극히 낮다. 단순하고 서버 사이의 동기화도 필요없고 규모 확장도 쉽다는 장점이 있지만 비트수가 길고 문자와 숫자가 섞여있다는 단점이 있다.

#### 티켓 서버
auto_increment 기능을 갖춘 데이터베이스를 티켓 서버로 중앙 집중형으로 하나만 두는 방식이다. 구현하기 쉽고 오직 숫자로만 만들 수 있으며 유일성이 보장되지만 티켓 서버가 SPOF가 될 수 있다.

#### 트위터 스노플레이크 접근법
이 방법은 id의 구조를 여러 section으로 분할하는 방법이다. 
크게 다음과 같이 나눌 수 있다.
- sign bit : 1비트를 할당하고 음수와 양수를 구별하는데 사용될 수 있다.
- timestamp : 41비트를 할당하고 utc 기준으로 몇 ms가 경과했는지를 나타내는 값이다.
- 데이터 센터 ID : 5비트를 할당한다
- 서버 ID : 5비트를 할당한다
- 일련번호 : 12비트를 할당한다.

## 3. 상세 설계
2단계에서 고안한 상세 설계 중 요구사항에 맞는 설계를 선택한다.(여기선 트위터 스노플레이트 접근법 선택)

## 4. 마무리
스노플레이크 방식은 요구사항을 만족하면서도 분산 환경에서 규모 확장이 가능한 방법이다. 하지만 남아있는 문제로는 시계 동기화(서버가 여러 코어에서 실행될 경우 유효하지 않을 수도 있다.), 각 section의 길이 최적화(동시성이 낮다면 일련번호를 줄이고 타임스탬프를 늘려서 시간을 더 확보할 수 있다.), 고가용성이 있다.